<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <link rel="stylesheet" href="/css/main.css">
    <script src="/js/main.js"></script>
    <title>Cpp_file_handling</title>
  </head>
  <body>
    <div id="main">
      <img class="banner" src="/images/the_mineshaft.jpg" alt="A first person view of a mineshaft from minecraft">
      <nav>
        <table id="nav">
          <tr>
            <td><a class="unselected" title="Main page" href="/">home</a></td>
            <td><a class="unselected" title="Mostly programs" href="/projects">projects</a></td>
            <td><a class="unselected" title="Videos" href="/videos">videos</a></td>
            <td><a class="unselected" title="Blog posts" href="/articles">articles</a></td>
            <td><a class="unselected" title="Socials" href="/contact">contact</a></td>
            <td><a class="unselected" title="Thanks" href="/credits">credits</a></td>
          </tr>
        </table>
      </nav>
      <h2 id="c-file-handling">C++ File Handling</h2>
<p>Over the years, I&rsquo;ve seen many tutorials on how to handle files in C++, but they always seem to have something missing. They might not explain filebufs, or ignore binary file handling, so with this article I aim to explain everything I have learned about how to use files in C++</p>
<h3 id="basic-string-io">Basic string I/O</h3>
<p>Here we will be using the fstream class, which requires you to include the fstream library</p>
<pre><code>#include &lt;iostream&gt;
#include &lt;fstream&gt;
using namespace std;
    
int main() {
  // The ofstream class is used exclusively for writing to files
  ofstream outFile;
    
  // Opens the file foo.txt and prepares it for writing, if foo.txt does not exist yet, outFile will create the file
  outFile.open(&quot;foo.txt&quot;);
    
  string writeStr = &quot;Hello, World!\n&quot;;
    
  // Writing formatted output to a file works just like cout
  outFile &lt;&lt; writeStr &lt;&lt; 42;
  cout &lt;&lt; &quot;Wrote &quot; &lt;&lt; writeStr &lt;&lt; 42 &lt;&lt; &quot; to foo.txt\n&quot;;
    
  // After using a file you should always remember to close it
  outFile.close();
    
  // The ifstream class is used exclusively for reading from files
  ifstream inFile;
    
  // Similar to opening a file for writing, but won't create one if one doesn't already exist
  inFile.open(&quot;foo.txt&quot;);
    
  string firstWord;
  string secondWord;
  int number;
    
  // reading formatted input works similarly to cin
  inFile &gt;&gt; firstWord &gt;&gt; secondWord &gt;&gt; number;
    
  cout &lt;&lt; &quot;Read &quot; &lt;&lt; firstWord &lt;&lt; &quot; &quot; &lt;&lt; secondWord &lt;&lt; &quot;\n&quot; &lt;&lt; number &lt;&lt; &quot; from foo.txt\n&quot;;
    
  inFile.close();
    
  return 0;
}
</code></pre>
<h3 id="binary-io">Binary I/O</h3>
<p>So storing human readable data is good and all, but what if you want to encrypt your data, or what if you want your files to be as compact as possible?<br>
Enter binary files, this lets you directly copy data from ram into a file and load it back when you&rsquo;re ready.</p>
<p>Note: working directly with binary can be much more difficult than using plaintext, see <a href="https://gcc.gnu.org/onlinedocs/libstdc++/manual/fstreams.html#std.io.filestreams.binary">this link</a> for details</p>
<pre><code>#include &lt;iostream&gt;
#include &lt;fstream&gt;
using namespace std;
    
// Struct that will be copied to a file
struct Person {
  char name[10];
  int age;
  int favoriteNumber;
};
    
int main() {
  // The filebuf class is lower level and recommended for binary I/O
  filebuf outFile;
    
  // Open file for writing raw data
  outFile.open(&quot;foo.bin&quot;, ios::out | ios::binary);
    
  Person output{
    &quot;Calvin&quot;,
    6,
    0
  };
    
  // Gives the function a pointer to the first byte of the data
  outFile.sputn((char*)(&amp;output), sizeof(Person));
  cout &lt;&lt; &quot;Wrote &quot; &lt;&lt; output.name &lt;&lt; ' ' &lt;&lt; output.age &lt;&lt; ' ' &lt;&lt; output.favoriteNumber &lt;&lt; &quot; to foo.bin\n&quot;;
    
  output = Person{
    &quot;Hobbes&quot;,
    1,
    3
  };
    
  outFile.sputn((char*)(&amp;output), sizeof(Person));
  cout &lt;&lt; &quot;Wrote &quot; &lt;&lt; output.name &lt;&lt; ' ' &lt;&lt; output.age &lt;&lt; ' ' &lt;&lt; output.favoriteNumber &lt;&lt; &quot; to foo.bin\n&quot;;
    
  outFile.close();
    
    
  filebuf inFile;
    
  inFile.open(&quot;foo.bin&quot;, ios::in | ios::binary);
    
  // Reserve memory for input
  Person input;
    
  // Gives the function a pointer to the new data location
  inFile.sgetn((char*)(&amp;input), sizeof(Person));
  cout &lt;&lt; &quot;Read &quot; &lt;&lt; input.name &lt;&lt; '\n' &lt;&lt; input.age &lt;&lt; '\n' &lt;&lt; input.favoriteNumber &lt;&lt; &quot; from foo.bin\n\n&quot;;
    
  inFile.sgetn((char*)(&amp;input), sizeof(Person));
  cout &lt;&lt; &quot;Read &quot; &lt;&lt; input.name &lt;&lt; '\n' &lt;&lt; input.age &lt;&lt; '\n' &lt;&lt; input.favoriteNumber &lt;&lt; &quot; from foo.bin\n\n&quot;;
    
  return 0;
}
</code></pre>
<p>Well, that&rsquo;s all! I hope this helps with what you&rsquo;re working on!</p>
<p><a href="/articles">go back</a></p>

    </div>
  </body>
</html>
